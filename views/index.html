<!DOCTYPE html>
<html lang="de" class="h-full text-white">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WF-TECH Dashboard</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        :root{--background-color:#0A0A10;--tile-bg:rgba(20,20,35,0.4);--tile-hover-bg:rgba(30,30,50,0.6);--border-color:rgba(255,255,255,0.1);--accent-purple:#a855f7;--accent-blue:#3b82f6}body{font-family:'Inter',sans-serif;background-color:var(--background-color);-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;overflow:hidden}#background-animation{position:fixed;top:0;left:0;width:100%;height:100%;z-index:-1;background:linear-gradient(315deg,rgba(168,85,247,0.1),transparent 40%),linear-gradient(45deg,rgba(59,130,246,0.1),transparent 40%),var(--background-color);animation:moveGradient 20s linear infinite}@keyframes moveGradient{0%{background-position:0 0}50%{background-position:100% 100%}100%{background-position:0 0}}.content-wrapper{position:relative;z-index:1;overflow-y:auto;height:100vh;scroll-behavior:smooth}.accent-gradient-text{background:linear-gradient(90deg,var(--accent-blue),var(--accent-purple));-webkit-background-clip:text;background-clip:text;color:transparent}.widget,.tile{background:var(--tile-bg);backdrop-filter:blur(16px);-webkit-backdrop-filter:blur(16px);border:1px solid var(--border-color);transition:all .3s cubic-bezier(.25,.8,.25,1)}.widget:hover,.tile:hover{background:var(--tile-hover-bg);transform:translateY(-8px) scale(1.03);box-shadow:0 10px 25px rgba(0,0,0,.3);border-color:var(--accent-purple)}.tile-icon{transition:all .3s ease}.tile:hover .tile-icon{transform:scale(1.1);color:#c084fc}.fade-in-up{animation:fadeInUp .8s ease-in-out}@keyframes fadeInUp{from{opacity:0;transform:translateY(30px)}to{opacity:1;transform:translateY(0)}}.action-btn{background:linear-gradient(90deg,var(--accent-blue),var(--accent-purple));transition:all .3s ease;box-shadow:0 4px 15px rgba(0,0,0,.2)}.action-btn:hover{transform:scale(1.05);box-shadow:0 6px 20px rgba(139,92,246,.4)}.logo{font-weight:700;font-size:1.5rem;letter-spacing:1px;background:linear-gradient(90deg,#e0e0e0,#a0a0a0);-webkit-background-clip:text;background-clip:text;color:transparent}.input-field{background:rgba(0,0,0,.3);border:1px solid var(--border-color);border-radius:.5rem;padding:.75rem;color:#fff;transition:border-color .3s}.input-field:focus{outline:0;border-color:var(--accent-blue)}.todo-item{display:flex;align-items:center;gap:.75rem;padding:.5rem 0}.todo-item input:checked+label{text-decoration:line-through;color:#6b7280}.modal-overlay{position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,.7);backdrop-filter:blur(5px);z-index:40;display:flex;align-items:center;justify-content:center}.modal-content{background:#111827;padding:2rem;border-radius:1rem;border:1px solid var(--border-color);width:90%;max-width:500px}
    </style>
</head>
<body class="h-full">
    <div id="background-animation"></div>
    <div id="app" class="content-wrapper p-4 sm:p-6 lg:p-8 flex flex-col fade-in-up">
        
        <header><!-- Header bleibt unverändert --></header>

        <main id="public-view" class="flex-grow w-full">
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-10">
                <!-- Wetter, Routenplaner, RSS Widgets bleiben unverändert -->
                <div id="weather-widget"></div>
                <!-- URL-Shortener Widget -->
                <div id="shortener-widget" class="widget rounded-2xl p-6">
                    <h3 class="font-bold text-lg text-white mb-3"><i class="fas fa-link mr-2"></i>URL Shortener</h3>
                    <div class="flex gap-2">
                        <input id="long-url-input" type="url" class="w-full input-field" placeholder="Lange URL hier einfügen...">
                        <button id="shorten-btn" class="action-btn text-white font-bold py-2 px-4 rounded-lg">Kürzen</button>
                    </div>
                    <div id="short-url-result" class="mt-4 hidden">
                        <p class="text-gray-400">Deine kurze URL:</p>
                        <div class="flex items-center gap-2 mt-1 bg-gray-800 p-2 rounded-lg">
                            <input id="short-url-output" type="text" class="bg-transparent text-green-400 font-mono w-full" readonly>
                            <button id="copy-btn" class="text-gray-400 hover:text-white" title="Kopieren"><i class="fas fa-copy"></i></button>
                        </div>
                    </div>
                </div>
                <div class="widget rounded-2xl p-6"></div>
                <div id="rss-widget"></div>
            </div>
            <!-- Rest der öffentlichen Ansicht bleibt unverändert -->
        </main>
        
        <main id="private-view" class="flex-grow w-full hidden">
            <!-- Private Ansicht bleibt unverändert -->
        </main>
        
        <footer class="mt-12 text-gray-500 flex justify-between items-center w-full">
             <!-- Footer bleibt unverändert -->
        </footer>
    </div>

    <div id="login-modal" class="modal-overlay hidden">
       <!-- Login Modal bleibt unverändert -->
    </div>

    <script>
        // Alle Hilfsfunktionen und Datenladefunktionen bleiben unverändert
        // ...

        // --- HAUPTLOGIK & EVENT LISTENERS ---
        document.addEventListener("DOMContentLoaded", () => {
            // ... (Alle bisherigen Initialisierungen und Listener bleiben hier)

            // --- URL Shortener Logik aktualisiert ---
            const shortenBtn = document.getElementById('shorten-btn');
            const longUrlInput = document.getElementById('long-url-input');
            const resultDiv = document.getElementById('short-url-result');
            const shortUrlOutput = document.getElementById('short-url-output');
            const copyBtn = document.getElementById('copy-btn');

            if (shortenBtn) {
                shortenBtn.addEventListener('click', () => {
                    const longUrl = longUrlInput.value;
                    if (!longUrl || !longUrl.startsWith('http')) {
                        alert('Bitte geben Sie eine gültige URL ein.');
                        return;
                    }

                    shortenBtn.disabled = true;
                    shortenBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i>';

                    fetch('/api/shorten', {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({ url: longUrl })
                    })
                    .then(res => res.json())
                    .then(data => {
                        if (data.error) {
                            throw new Error(data.error);
                        }
                        shortUrlOutput.value = data.shortUrl;
                        resultDiv.classList.remove('hidden');
                    })
                    .catch(err => {
                        console.error('Fehler beim Kürzen:', err);
                        alert(err.message);
                    })
                    .finally(() => {
                        shortenBtn.disabled = false;
                        shortenBtn.innerHTML = 'Kürzen';
                    });
                });
            }

            if (copyBtn) {
                copyBtn.addEventListener('click', () => {
                    shortUrlOutput.select();
                    document.execCommand('copy');
                    copyBtn.innerHTML = '<i class="fas fa-check text-green-500"></i>';
                    setTimeout(() => { copyBtn.innerHTML = '<i class="fas fa-copy"></i>'; }, 2000);
                });
            }
        });
    </script>
</body>
</html>
